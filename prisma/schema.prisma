generator client {
   provider = "prisma-client"
   output   = "../src/generated/prisma"
}

datasource db {
   provider = "postgresql"
}

model Users {
   id        Int      @id @default(autoincrement())
   fullName  String
   email     String   @unique
   password  String
   role      UserRole @default(USER)
   verified  DateTime
   basket    Basket?
   orders    Order[]
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
}

model Tours {
   id         Int         @id @default(autoincrement())
   title      String
   imageUrl   String
   date       DateTime
   oldPrice   Int
   price      Int
   rating     Float
   createdAt  DateTime    @default(now())
   updatedAt  DateTime    @updatedAt
   baskets    Basket[]
   orderItems OrderItem[]
}

model Basket {
   id Int @id @default(autoincrement())

   user      Users    @relation(fields: [userId], references: [id])
   userId    Int      @unique
   tour      Tours    @relation(fields: [tourId], references: [id])
   tourId    Int
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
}

model Order {
   id Int @id @default(autoincrement())

   items      OrderItem[]
   user       Users?      @relation(fields: [usersId], references: [id])
   usersId    Int?
   totalPrice Int
   status     OrderStatus
   createdAt  DateTime    @default(now())
   updatedAt  DateTime    @updatedAt
}

model OrderItem {
   id Int @id @default(autoincrement())

   order   Order @relation(fields: [orderId], references: [id])
   orderId Int

   tour   Tours @relation(fields: [tourId], references: [id])
   tourId Int

   price Int

   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
}

enum OrderStatus {
   PENDING
   COMPLETED
   CANCELED
}

enum UserRole {
   USER
   ADMIN
}
